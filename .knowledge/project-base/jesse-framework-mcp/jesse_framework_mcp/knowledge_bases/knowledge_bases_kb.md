<!-- ⚠️ DO NOT EDIT MANUALLY! DOCUMENT AUTOMATICALLY GENERATED! ⚠️ -->
<!-- This file is automatically generated by the JESSE Knowledge Base system. -->
<!-- Manual edits will be overwritten during the next generation cycle. -->
<!-- To modify content, update the source files and regenerate the knowledge base. -->
# Directory Knowledge Base {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/

## Global Summary

#### Functional Intent & Features

This directory implements the comprehensive Knowledge Bases Hierarchical Indexing System for the Jesse Framework MCP, providing automated knowledge base maintenance through `FastMCP` tool and resource interfaces with intelligent caching and LLM-powered content analysis. The system delivers standardized MCP protocol integration enabling external clients to trigger indexing operations, monitor system status, and access configuration resources through `jesse://knowledge_bases/` URI endpoints. Key semantic entities include `register_knowledge_bases_tools` and `register_knowledge_bases_resources` functions for `FastMCP` server integration, `HierarchicalIndexer` orchestrating Plan-then-Execute architecture workflows, `KnowledgeBuilder` providing LLM-powered content summarization through `StrandsClaude4Driver`, `FileAnalysisCache` implementing timestamp-based staleness detection, `IndexingConfig` and `IndexingMode` for comprehensive configuration management, `DirectoryContext` and `FileContext` for hierarchical processing state tracking, `DecisionReport` and `ExecutionPlan` for audit trail maintenance, `MCP server` architecture enabling context loading and intelligent codebase understanding, background scanning technology with semantic context databases, and specialized handlers `ProjectBaseHandler` and `GitCloneHandler` for scenario-specific processing. The framework establishes automated knowledge base generation through leaf-first hierarchical processing, bottom-up assembly patterns, and progressive intelligence enhancement across `.knowledge/` directory structures.

##### Main Components

The directory contains three primary MCP integration modules and five specialized subdirectories implementing the complete indexing architecture. Core MCP interface modules include `resources.py` providing `FastMCP` resource endpoints for configuration access and system documentation, `tools.py` implementing MCP tool interfaces for manual indexing operations and status monitoring, and `__init__.py` serving as the centralized package initialization with comprehensive component exports. The `indexing/` subdirectory contains the core hierarchical processing engine with `HierarchicalIndexer`, `KnowledgeBuilder`, `RebuildDecisionEngine`, `PlanGenerator`, and `ExecutionEngine` implementing Plan-then-Execute architecture. The `models/` subdirectory provides comprehensive data model foundation through `IndexingConfig`, `DirectoryContext`, `FileContext`, `DecisionReport`, and `ExecutionPlan` classes supporting type-safe configuration management and runtime context tracking. The `tests/` subdirectory represents testing infrastructure for system validation. Each component implements async-first architecture patterns with `FastMCP Context` integration, comprehensive error handling with graceful degradation, and defensive programming patterns ensuring robust operation across diverse filesystem configurations.

###### Architecture & Design

The architecture implements a layered MCP integration pattern with `FastMCP` server interfaces bridging external client requests to internal hierarchical indexing capabilities through standardized tool and resource protocols. The design separates MCP protocol concerns from core indexing logic through clean abstraction layers, enabling independent evolution of client interfaces and processing algorithms. The system employs Plan-then-Execute architecture separating decision-making from execution through distinct phases: discovery builds complete directory hierarchy context, decision analysis generates comprehensive rebuild reports, plan generation converts decisions into atomic tasks with dependencies, and execution performs dependency-aware task processing. The indexing architecture follows leaf-first hierarchical processing ensuring proper dependency ordering where parent directories wait for all child completion through bottom-up assembly patterns. The design implements cache-first processing strategies through `FileAnalysisCache` integration with selective bypass mechanisms for rebuild scenarios, comprehensive configuration management through hierarchical `IndexingConfig` organization, and immutable data model architecture using frozen dataclasses ensuring thread safety and audit trail integrity across all processing components.

####### Implementation Approach

The implementation utilizes `FastMCP` decorator patterns with `@server.tool()` and `@server.resource()` for endpoint registration, enabling standardized MCP protocol integration with comprehensive parameter validation and HTTP-formatted response generation. Tool execution employs global state management through `_current_indexer` variable preventing concurrent operations while providing real-time progress reporting through `FastMCP Context` integration. Resource provision implements read-only access patterns ensuring system configuration integrity while delivering comprehensive documentation and usage guidance through structured HTTP responses. The core indexing implementation executes five-phase Plan-then-Execute workflows: recursive directory discovery building complete hierarchy context, centralized decision analysis through `RebuildDecisionEngine` with file-first optimization, atomic task generation via `PlanGenerator` with comprehensive dependency management, execution preview for debugging and validation, and dependency-aware task execution through `ExecutionEngine` with performance metrics collection. The system employs continuation-based retry mechanisms maintaining conversation context across truncation recovery attempts, timestamp-based staleness detection through direct filesystem comparison, and comprehensive path mapping between source files and knowledge base structure using project-base directory mirroring with portable path handling for cross-platform compatibility.

######## External Dependencies & Integration Points

**→ Inbound:**
- `fastmcp.FastMCP` (external library) - MCP server framework enabling tool and resource registration with standardized protocol implementation
- `fastmcp.Context` (external library) - MCP context interface for async progress reporting and user interaction throughout indexing workflows
- `jesse_framework_mcp.llm.strands_agent_driver.StrandsClaude4Driver` - Claude 4 Sonnet LLM integration for content analysis and knowledge generation
- `jesse_framework_mcp.llm.strands_agent_driver.Claude4SonnetConfig` - LLM configuration optimization for analysis tasks and conversation management
- `jesse_framework_mcp.helpers.async_http_formatter.format_http_response` - HTTP response formatting utility ensuring JESSE Framework consistency across MCP endpoints
- `jesse_framework_mcp.helpers.path_utils.get_portable_path` - Cross-platform path conversion utility for consistent path formatting and knowledge base organization
- `mistletoe` (external library) - AST-based markdown parsing and rendering for reliable document manipulation and content extraction
- `pathlib.Path` (external library) - Cross-platform path operations and filesystem metadata access for directory traversal and file processing
- `asyncio` (external library) - Async programming patterns and concurrency control for performance optimization and parallel processing
- `json` (external library) - Configuration serialization and debug metadata persistence for external system integration
- `pydantic` (external library) - Configuration validation and type safety for indexing parameters and data model integrity

**← Outbound:**
- `jesse_framework_mcp/main.py:JesseFrameworkMCPServer` - MCP server consuming package exports for knowledge base functionality integration and tool registration
- `jesse_framework_mcp/server.py` - Server initialization consuming tool and resource registration functions for complete MCP service deployment
- `{PROJECT_ROOT}/.knowledge/project-base/` - Generated knowledge base files with hierarchical structure mirroring source directory organization
- `{PROJECT_ROOT}/.knowledge/git-clones/` - Specialized knowledge structures for git repository processing with read-only mirrored organization
- `debug_output/llm_debug/` - Debug interaction capture files for development workflow support and LLM interaction replay
- `cache_files/*.analysis.md` - Cached analysis files for performance optimization and staleness detection with metadata preservation
- External MCP clients - Consuming registered tools and resources through standardized MCP protocol for knowledge base operations
- Monitoring systems - Performance statistics and decision audit trails for system reliability tracking and optimization analysis

**⚡ System role and ecosystem integration:**
- **System Role**: Comprehensive MCP integration layer for the Jesse Framework knowledge base indexing system, serving as the primary interface between external MCP clients and internal hierarchical processing capabilities while coordinating all phases of automated knowledge base maintenance
- **Ecosystem Position**: Core infrastructure component bridging MCP protocol requirements with specialized indexing algorithms, serving as the central orchestrator for knowledge base operations within the broader Jesse Framework MCP server architecture
- **Integration Pattern**: Used by MCP server during initialization for tool and resource registration, consumed by external MCP clients through standardized protocol interfaces, integrated with specialized scenario handlers for comprehensive knowledge base coverage, and coordinating with LLM-powered content generation through structured Plan-then-Execute workflows while providing comprehensive debugging and monitoring capabilities for development and production environments

######### Edge Cases & Error Handling

The system implements comprehensive error handling across multiple operational layers including MCP protocol validation, filesystem access restrictions, LLM processing failures, and concurrent operation conflicts. MCP tool execution handles invalid parameters through early validation with HTTP 400 Bad Request responses, concurrent operation prevention through global indexer state checking returning HTTP 409 Conflict responses, and comprehensive exception catching with structured logging and HTTP 500 Internal Server Error responses containing detailed debugging context. The indexing system addresses truncation detection through `TruncationDetectedError` preventing artifact creation when LLM responses are incomplete, empty directory handling by detecting contentless directories and skipping knowledge file generation, filesystem access restrictions with `OSError` and `PermissionError` catching enabling continued processing, and cache failures ensuring cache operations never break core knowledge building processes through conservative fallback decisions. Resource provision handles missing configuration files through automatic generation from centralized defaults, JSON parsing errors with descriptive error messages, and resource access failures providing clear guidance through formatted error responses. The system manages strategic pivot scenarios through comprehensive metrics tracking enabling rapid detection of market rejection, adoption challenges, or competitive response requiring strategic adjustment, while providing bounded loop reviewer workflows preventing infinite loops through maximum iteration limits and preserving LLM work through forced caching mechanisms.

########## Internal Implementation Details

The MCP integration layer utilizes global `_current_indexer` variable with Optional typing for thread-safe operation coordination and conflict prevention during concurrent tool invocations. Tool registration employs nested function definitions within `register_knowledge_bases_tools()` enabling clean encapsulation and shared access to indexer state while maintaining FastMCP decorator compatibility. Resource endpoints implement URI-based identification following `jesse://knowledge_bases/` namespace conventions with hierarchical organization through `config/`, `templates/`, and `documentation/` path segments. The indexing system maintains performance tracking through `_decisions_made`, `_filesystem_operations`, and `_decision_start_time` counters for optimization monitoring across all processing phases. Cache implementation uses HTML comment metadata blocks with `CACHE_VERSION = "1.0"` for future compatibility and migration support, while employing direct timestamp comparison without tolerance for consistent staleness detection behavior. The execution engine maintains internal state through three sets tracking completed, failed, and running tasks with `asyncio.Semaphore(config.max_concurrent_operations)` for resource management. Configuration management uses `object.__setattr__()` to modify frozen dataclass fields during initialization when setting default knowledge directory, while implementing property accessors for backward compatibility delegation to hierarchical configuration groups. The debug system employs hash-based interaction identification combining prompt content hashes with timestamps for unique interaction IDs enabling efficient debug replay functionality with cross-platform filename compatibility through path normalization algorithms.

########### Usage Examples

**Complete MCP server integration with knowledge base functionality:**

This example demonstrates initializing a FastMCP server with comprehensive knowledge base tools and resources, enabling external clients to perform indexing operations and access system configuration through standardized MCP protocol interfaces.

```python
from fastmcp import FastMCP
from jesse_framework_mcp.knowledge_bases import (
    register_knowledge_bases_tools,
    register_knowledge_bases_resources
)

# Initialize FastMCP server with knowledge base functionality
server = FastMCP("Jesse Framework MCP")
register_knowledge_bases_tools(server)
register_knowledge_bases_resources(server)

# Server now provides standardized MCP tools and resources
# Tools: knowledge_bases_index_trigger, knowledge_bases_status, knowledge_bases_search
# Resources: jesse://knowledge_bases/config/default, jesse://knowledge_bases/templates/usage_examples
```

**Manual indexing operation through MCP tool interface:**

This pattern shows how external MCP clients invoke knowledge base indexing operations with configurable parameters, progress reporting, and comprehensive error handling through the standardized tool interface.

```python
# MCP client tool invocation for manual indexing (conceptual client-side code)
indexing_response = await mcp_client.call_tool(
    "knowledge_bases_index_trigger",
    {
        "target_path": "./src/",
        "indexing_mode": "incremental",
        "enable_git_clone_indexing": True,
        "enable_project_base_indexing": False
    }
)

# Expected response structure with comprehensive operation results
{
    "status": "completed",
    "target_path": "/absolute/path/to/src/",
    "indexing_mode": "incremental",
    "statistics": {
        "files_processed": 145,
        "directories_processed": 23,
        "llm_calls_made": 67,
        "cache_hits": 78
    },
    "completion_percentage": 100.0,
    "operation_summary": {
        "total_files_discovered": 150,
        "files_completed": 145,
        "files_failed": 5,
        "processing_duration": "00:05:23"
    }
}
```

**Hierarchical indexing workflow with Plan-then-Execute architecture:**

This example demonstrates the complete indexing workflow coordination from configuration through execution, showcasing the Plan-then-Execute architecture with comprehensive progress tracking and performance analysis.

```python
from jesse_framework_mcp.knowledge_bases import (
    HierarchicalIndexer,
    IndexingConfig,
    IndexingMode
)
from pathlib import Path

# Configure and execute comprehensive hierarchical indexing
config = IndexingConfig(
    handler_type="project-base",
    indexing_mode=IndexingMode.INCREMENTAL,
    max_concurrent_operations=4,
    debug_mode=True
)

indexer = HierarchicalIndexer(config)

# Execute five-phase Plan-then-Execute workflow
async def run_complete_indexing(source_root, ctx):
    # Phase 1: Discovery - build complete directory hierarchy context
    # Phase 2: Decision Analysis - generate comprehensive rebuild decisions
    # Phase 3: Plan Generation - convert decisions to atomic tasks with dependencies
    # Phase 4: Plan Preview - validate execution strategy and resource requirements
    # Phase 5: Atomic Execution - perform dependency-aware task execution
    
    status = await indexer.index_hierarchy(source_root, ctx)
    
    print(f"Processing: {status.processing_stats.progress_percentage:.1f}%")
    print(f"LLM calls: {status.processing_stats.llm_calls_made}")
    print(f"Files processed: {status.processing_stats.files_processed}")
    print(f"Cache hits: {status.processing_stats.cache_hits}")
    
    return status

# Cleanup resources after processing
await indexer.cleanup()
```

## Subdirectory Knowledge Integration

### {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/indexing/
*Last Updated: 2025-07-06T23:12:03Z*

Comprehensive hierarchical knowledge base indexing system implementing Plan-then-Execute architecture for the Jesse Framework MCP Server, providing automated content analysis, structured knowledge file generation, and intelligent caching for large-scale codebase documentation. The system orchestrates LLM-powered content summarization through `HierarchicalIndexer`, `KnowledgeBuilder`, and `RebuildDecisionEngine` components with bottom-up assembly strategies ensuring child completion before parent processing. Enables developers to maintain synchronized knowledge bases through change detection, selective rebuilds, and atomic task execution with comprehensive error handling and performance optimization. Key semantic entities include `HierarchicalIndexer` for workflow orchestration, `FileAnalysisCache` for performance optimization, `ExecutionEngine` for dependency-aware task execution, `PlanGenerator` for decision-to-task translation, `StrandsClaude4Driver` for LLM integration, `IndexingConfig` for configuration management, `DirectoryContext` and `FileContext` for structure representation, `DecisionReport` and `ExecutionPlan` for workflow coordination, `EnhancedPrompts` for specialized analysis templates, and `DebugHandler` for development workflow support using async-first architecture patterns with `FastMCP` context integration.

### {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/models/
*Last Updated: 2025-07-06T23:12:03Z*

Comprehensive data model foundation for the Jesse Framework MCP's Knowledge Bases Hierarchical Indexing System, providing type-safe configuration management, runtime context tracking, decision modeling, and execution planning through immutable dataclass structures. The system delivers centralized model definitions enabling consistent data contracts across all indexing components, comprehensive validation at initialization time, and serialization support for external system integration. Enables developers to implement robust knowledge base indexing workflows with structured configuration management, hierarchical processing state tracking, audit trail maintenance, and Plan-then-Execute architecture coordination. Key semantic entities include `IndexingConfig` for system configuration with handler-specific templates, `DirectoryContext` and `FileContext` for hierarchical processing state, `DecisionReport` and `RebuildDecision` for centralized decision logic, `ExecutionPlan` and `AtomicTask` for atomic task execution, `ProcessingStatus` and `IndexingMode` enumerations for state management, `@dataclass(frozen=True)` for immutable structures, `field(default_factory=datetime.now)` for automatic timestamp tracking, and comprehensive validation through `__post_init__()` methods ensuring data integrity across all model types.

### {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/tests/
*Last Updated: 2025-07-06T23:12:03Z*

*No detailed content available from tests_kb.md*

## File Knowledge Integration

### {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/__init__.py

*Last Updated: 2025-07-06T23:12:03Z*

#### Functional Intent & Features

This file serves as the package initialization module for the Jesse Framework Knowledge Bases Hierarchical Indexing System, providing centralized FastMCP tool and resource registration for automated knowledge base maintenance throughout the `.knowledge/` directory hierarchy using leaf-first processing strategy. The module enables comprehensive knowledge base management through standardized MCP interfaces, implementing the Hierarchical Semantic Context pattern with bottom-up assembly and no parent-to-child context flow. Key semantic entities include `register_knowledge_bases_tools` function for MCP tool registration, `register_knowledge_bases_resources` function for MCP resource registration, `HierarchicalIndexer` class for core processing orchestration, `IndexingConfig` and `IndexingMode` for configuration management, `__all__` export list defining public API surface, `__version__` string for package versioning, `FastMCP` integration patterns, `strands_agent_driver` LLM integration, leaf-first hierarchical processing strategy, change detection and incremental updates, and specialized handling for git-clones and project-base scenarios. The system implements async-first design following Jesse Framework standards with comprehensive error handling and defensive programming patterns.

##### Main Components

The package exports five core components through the `__all__` list: `register_knowledge_bases_tools` function for registering MCP tools with FastMCP server, `register_knowledge_bases_resources` function for registering MCP resources, `HierarchicalIndexer` class providing the core indexing orchestration capabilities, `IndexingConfig` class for system configuration management, and `IndexingMode` enumeration for processing strategy selection. The module imports these components from specialized submodules including `.tools` for MCP tool implementations, `.resources` for MCP resource interfaces, `.indexing` for core hierarchical processing logic, and `.models` for data structures and configuration. Package metadata includes `__version__ = "1.0.0"` for version tracking and comprehensive docstring describing key features including leaf-first hierarchical processing, FastMCP tool integration, Strands Agent Driver LLM integration, change detection capabilities, and special handling scenarios.

###### Architecture & Design

The architecture implements a centralized package initialization pattern with clear separation between tool registration, resource registration, and core processing functionality. The design follows FastMCP-first architecture with tool and resource registration patterns, implementing the Hierarchical Semantic Context pattern for structured knowledge file maintenance. Key design patterns include the package initialization pattern for centralized component exports, async-first architecture following Jesse Framework standards, bottom-up assembly pattern with no parent-to-child context flow, defensive programming with comprehensive error handling, and modular component organization separating tools, resources, indexing logic, and data models. The system uses explicit `__all__` declaration to control public API surface and maintain clean dependency management across the knowledge base system components.

####### Implementation Approach

The implementation uses Python's standard package initialization mechanism with explicit imports from specialized submodules using relative import syntax. The approach employs centralized component aggregation through `__all__` list definition, enabling clean external access to all knowledge base functionality through a single import point. Component organization follows functional separation with tools, resources, indexing logic, and models grouped into distinct modules for maintainability and clear responsibility boundaries. The module maintains no internal state or business logic, serving purely as an aggregation and export point for knowledge base components. Version management uses semantic versioning with `__version__` string for package tracking and compatibility management. Documentation follows comprehensive docstring patterns describing system capabilities and key features for developer understanding.

######## External Dependencies & Integration Points

**→ Inbound:**
- `.tools:register_knowledge_bases_tools` - MCP tool registration function for manual indexing operations and system monitoring
- `.resources:register_knowledge_bases_resources` - MCP resource registration function for configuration and documentation access
- `.indexing:HierarchicalIndexer` - core indexing orchestrator providing hierarchical processing capabilities
- `.models:IndexingConfig` - configuration data model for system parameter management
- `.models:IndexingMode` - enumeration defining processing strategies for indexing operations

**← Outbound:**
- `jesse_framework_mcp/main.py:JesseFrameworkMCPServer` - MCP server consuming package exports for knowledge base functionality integration
- `jesse_framework_mcp/server.py` - server initialization consuming tool and resource registration functions
- External MCP clients - consuming registered tools and resources through FastMCP protocol
- Development tools - importing knowledge base components for automated documentation and maintenance workflows
- Configuration systems - using IndexingConfig and IndexingMode for system setup and parameter management

**⚡ System role and ecosystem integration:**
- **System Role**: Central package interface for the Jesse Framework knowledge base indexing system, providing unified access to all knowledge base functionality including tools, resources, and core processing capabilities
- **Ecosystem Position**: Core infrastructure component serving as the primary entry point for knowledge base operations within the Jesse Framework MCP ecosystem
- **Integration Pattern**: Used by MCP server during initialization for tool and resource registration, consumed by external systems through standardized MCP interfaces, and integrated with development workflows for automated knowledge base maintenance

######### Edge Cases & Error Handling

Import failures from any of the four core submodules result in package initialization failure, preventing the entire knowledge base system from becoming available. Missing or corrupted submodules cause import errors that propagate to the MCP server initialization, requiring proper error handling at the server level. Circular dependency scenarios between exported components are prevented through the package structure but could emerge from future architectural changes. Version compatibility issues between the package and its submodules could lead to API inconsistencies or missing functionality. The package provides no error handling mechanisms itself, relying on Python's import system to surface module loading issues and individual components to handle their specific error conditions. Tool and resource registration failures during MCP server initialization would prevent knowledge base functionality from being available to external clients.

########## Internal Implementation Details

The package uses Python's standard relative import mechanism with dot notation to reference submodules within the same package directory. Import statements are organized logically with tool registration first, followed by resource registration, core indexing logic, and data models, maintaining clear architectural layering. The `__all__` list uses explicit string literals for each exported component name, ensuring precise control over the public API surface and preventing accidental exposure of internal implementation details. Module-level imports are performed at package initialization time, making all components immediately available upon successful import without lazy loading or dynamic import mechanisms. The package maintains comprehensive documentation through docstring with feature descriptions and architectural overview for developer understanding. Version management follows semantic versioning principles with string-based version identifier for compatibility tracking.

########### Code Usage Examples

Basic package import demonstrates the unified access pattern for all knowledge base functionality. This approach provides clean dependency management and consistent API access across the Jesse Framework MCP system.

```python
# Import all knowledge base components through unified package interface
from jesse_framework_mcp.knowledge_bases import (
    register_knowledge_bases_tools,
    register_knowledge_bases_resources,
    HierarchicalIndexer,
    IndexingConfig,
    IndexingMode
)

# Initialize MCP server with knowledge base functionality
server = FastMCP("jesse-framework-mcp")
register_knowledge_bases_tools(server)
register_knowledge_bases_resources(server)
```

Selective component import enables targeted usage for specific functionality requirements. This pattern supports modular development and reduces import overhead for specialized use cases.

```python
# Import only required components for specific operations
from jesse_framework_mcp.knowledge_bases import HierarchicalIndexer, IndexingConfig

# Create configuration and indexer for direct usage
config = IndexingConfig(indexing_mode=IndexingMode.INCREMENTAL)
indexer = HierarchicalIndexer(config)

# Execute hierarchical indexing operation
status = await indexer.index_hierarchy(Path("./knowledge"), ctx)
```

### {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/resources.py

*Last Updated: 2025-07-06T23:12:03Z*

#### Functional Intent & Features

This module provides FastMCP resource interfaces for the Knowledge Bases Hierarchical Indexing System, enabling standardized access to system configuration, usage templates, and documentation through MCP resource endpoints. The functional intent centers on exposing read-only system information through HTTP-formatted responses that maintain consistency with JESSE Framework patterns. Key semantic entities include `FastMCP` server integration, `IndexingConfig` configuration models, `format_http_response` HTTP formatting utilities, and three primary resource endpoints: `jesse://knowledge_bases/config/default`, `jesse://knowledge_bases/templates/usage_examples`, and `jesse://knowledge_bases/documentation/system_overview`. The module implements comprehensive resource registration patterns supporting configuration analysis, workflow template provision, and system documentation access for effective knowledge base system utilization.

##### Main Components

The module contains four primary components: `register_knowledge_bases_resources()` function serving as the central resource registration orchestrator, `knowledge_bases_default_config()` resource handler providing access to default `IndexingConfig` parameters, `knowledge_bases_usage_examples()` resource handler delivering practical usage templates and workflow examples, and `knowledge_bases_system_overview()` resource handler exposing comprehensive system architecture documentation. Each resource handler implements async response patterns with comprehensive error handling and HTTP-formatted output generation.

###### Architecture & Design

The architecture follows FastMCP resource registration patterns with decorator-based resource endpoint definition and centralized registration through the main orchestrator function. Design principles emphasize read-only resource access ensuring system configuration integrity, HTTP-formatted responses maintaining JESSE Framework consistency, and comprehensive resource coverage supporting both configuration analysis and usage guidance. The structure implements separation of concerns with distinct resource handlers for configuration, templates, and documentation, each maintaining independent error handling and response formatting.

####### Implementation Approach

The implementation utilizes FastMCP's `@server.resource()` decorator pattern for endpoint registration with URI-based resource identification following `jesse://knowledge_bases/` namespace conventions. Each resource handler implements try-catch error handling with detailed logging through the `logger` instance, JSON serialization for structured data responses, and `format_http_response()` utility integration for consistent HTTP formatting. The approach emphasizes comprehensive data provision with metadata enrichment, practical example structuring, and detailed documentation assembly for effective system understanding and utilization.

######## External Dependencies & Integration Points

**→ Inbound:**
- `.models.IndexingConfig` - Configuration data model providing system parameter defaults and serialization
- `..helpers.async_http_formatter.format_http_response` - HTTP response formatting utility ensuring JESSE Framework consistency
- `fastmcp.FastMCP` (external library) - MCP server framework enabling resource registration and endpoint management
- `json` (standard library) - JSON serialization for configuration data and response formatting
- `logging` (standard library) - Error tracking and operational logging

**← Outbound:**
- MCP client applications consuming `jesse://knowledge_bases/*` resource endpoints
- JESSE Framework components requiring knowledge base configuration and usage guidance
- Development tools and documentation systems accessing system overview resources

**⚡ System role and ecosystem integration:**
- **System Role**: Serves as the primary MCP resource interface layer for the Knowledge Bases Hierarchical Indexing System, bridging internal configuration and documentation with external MCP client access
- **Ecosystem Position**: Core integration component enabling standardized access to system information and usage guidance through FastMCP resource protocol
- **Integration Pattern**: Consumed by MCP clients, development tools, and JESSE Framework components requiring read-only access to system configuration, templates, and documentation

######### Edge Cases & Error Handling

Error handling implements comprehensive exception catching with detailed logging through `logger.error()` calls including stack traces via `exc_info=True`. Each resource handler provides graceful degradation returning HTTP 500 responses with structured error information including error messages and exception details. Edge cases include `IndexingConfig` instantiation failures handled through default configuration fallback, JSON serialization errors managed through exception catching, and resource access failures providing clear guidance through formatted error responses with actionable error details.

########## Internal Implementation Details

Internal mechanisms utilize `IndexingConfig().to_dict()` method for configuration serialization, structured data assembly with metadata enrichment for comprehensive resource responses, and consistent error logging patterns across all resource handlers. The implementation maintains response data structuring with description fields, usage guidance, and customization notes for enhanced resource value. Resource URI patterns follow hierarchical organization with `config/`, `templates/`, and `documentation/` path segments enabling logical resource categorization and discovery.

########### Code Usage Examples

**Resource registration in FastMCP server initialization:**
```python
from fastmcp import FastMCP
from jesse_framework_mcp.knowledge_bases.resources import register_knowledge_bases_resources

server = FastMCP("knowledge-bases-server")
register_knowledge_bases_resources(server)
```

**Accessing default configuration resource:**
```python
# MCP client resource access
config_resource = await client.read_resource("jesse://knowledge_bases/config/default")
config_data = json.loads(config_resource)["configuration"]
```

**Resource response structure example:**
```python
# Typical resource response format
response_data = {
    "configuration": config_data,
    "description": "Default configuration for Knowledge Bases Hierarchical Indexing System",
    "usage": "These parameters control indexing behavior, LLM integration, and processing constraints"
}
```

### {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases/tools.py

*Last Updated: 2025-07-06T23:12:03Z*

#### Functional Intent & Features

The `tools.py` file serves as the FastMCP tools integration layer for the Jesse Framework MCP's knowledge base hierarchical indexing system, providing standardized MCP tool interfaces for manual indexing operations, system status monitoring, and search capabilities through the FastMCP server framework. This module enables user-initiated knowledge base operations through MCP protocol integration, evidenced by the `register_knowledge_bases_tools()` function that registers three tools with the FastMCP server and the global `_current_indexer` variable for operation coordination. Key semantic entities include `FastMCP` server integration, `@server.tool()` decorators for tool registration, `Context` parameter for progress reporting, `HierarchicalIndexer` for core processing operations, `IndexingConfig` and `IndexingMode` for configuration management, `format_http_response()` for consistent response formatting, tool functions `knowledge_bases_index_trigger()`, `knowledge_bases_status()`, and `knowledge_bases_search()`, and comprehensive error handling with HTTP status codes (400, 404, 409, 500, 501). The system implements async-first architecture supporting concurrent operations with real-time feedback through FastMCP Context integration and HTTP-formatted responses following JESSE Framework patterns.

##### Main Components

The file contains the primary `register_knowledge_bases_tools()` function that serves as the central tool registration point, three MCP tool implementations as nested functions within the registration function, and a global `_current_indexer` variable for operation state management. The `knowledge_bases_index_trigger()` tool provides manual indexing capabilities with configurable parameters including `target_path`, `indexing_mode`, `enable_git_clone_indexing`, and `enable_project_base_indexing`. The `knowledge_bases_status()` tool offers real-time status monitoring and statistics retrieval for ongoing and completed indexing operations. The `knowledge_bases_search()` tool serves as a placeholder for future search functionality with parameters for `query`, `search_scope`, and `max_results`. Each tool implements comprehensive error handling, progress reporting through FastMCP Context, and HTTP-formatted response generation for consistency with JESSE Framework patterns.

###### Architecture & Design

The architecture follows a centralized tool registration pattern where all MCP tools are defined as nested functions within the `register_knowledge_bases_tools()` function, enabling clean encapsulation and shared access to the global indexer state. The design implements async-first patterns throughout with all tool functions declared as async and using await for I/O operations and progress reporting. The system uses a global state management approach through the `_current_indexer` variable to coordinate operations and prevent concurrent indexing conflicts. Each tool follows a consistent three-section documentation pattern as specified in JESSE_CODE_COMMENTS.md, with tool intent, design principles, and implementation details clearly separated. The architecture integrates HTTP response formatting through the `format_http_response()` helper function, ensuring consistent response structures across all tools with appropriate HTTP status codes and content types.

####### Implementation Approach

The implementation uses FastMCP's `@server.tool()` decorator pattern for tool registration with descriptive names and documentation strings that appear in MCP client interfaces. Tool parameter validation employs early validation patterns with immediate HTTP error responses for invalid inputs, including IndexingMode validation and path existence checking. The system implements conflict detection through global state checking, preventing concurrent indexing operations by returning HTTP 409 Conflict responses when operations are already in progress. Progress reporting uses FastMCP Context methods (`ctx.info()`, `ctx.error()`) for real-time user feedback during long-running operations. Response generation follows a consistent pattern using `format_http_response()` with appropriate HTTP status codes, structured data payloads, and JSON content types for successful operations, while error responses include detailed error information and debugging context.

######## External Dependencies & Integration Points

**→ Inbound:** [MCP tools integration dependencies]
- `fastmcp:Context` - progress reporting and user feedback during tool execution
- `fastmcp.server:FastMCP` - MCP server framework for tool registration and execution
- `.indexing:HierarchicalIndexer` - core indexing orchestrator for processing operations
- `.models:IndexingConfig` - configuration data model for indexing parameters
- `.models:IndexingMode` - enumeration for processing mode validation
- `..helpers.async_http_formatter:format_http_response` - HTTP response formatting for consistency
- `pathlib` (external library) - cross-platform path operations for tool parameters
- `asyncio` (external library) - async programming patterns for concurrent operations
- `logging` (external library) - structured logging for tool operation tracking

**← Outbound:** [MCP tools consumers]
- `FastMCP server instances` - consume registered tools through MCP protocol integration
- `MCP clients` - invoke tools through standardized MCP tool interface protocol
- `Jesse Framework MCP server` - integrates tools into broader MCP server functionality
- `User interfaces` - access tools through MCP-compatible clients and applications

**⚡ System role and ecosystem integration:**
- **System Role**: MCP protocol bridge that exposes knowledge base indexing functionality through standardized tool interfaces, enabling user-initiated operations and system monitoring within the Jesse Framework MCP ecosystem
- **Ecosystem Position**: Interface layer component that connects FastMCP server infrastructure with core indexing functionality, serving as the primary user interaction point for knowledge base operations
- **Integration Pattern**: Used by MCP server during initialization through tool registration, consumed by MCP clients through protocol-standard tool invocation, and integrated with core indexing system through HierarchicalIndexer coordination

######### Edge Cases & Error Handling

The system handles invalid indexing mode parameters through `IndexingMode` enum validation, returning HTTP 400 Bad Request responses with detailed error messages listing valid modes. Concurrent operation conflicts are managed through global indexer state checking, preventing multiple simultaneous indexing operations by returning HTTP 409 Conflict responses. File system validation includes path existence checking and directory validation, returning HTTP 404 Not Found for missing paths and HTTP 400 Bad Request for non-directory targets. Exception handling uses comprehensive try-catch blocks with structured logging through the logger instance and detailed error responses including exception details and context information. The search tool handles future functionality through HTTP 501 Not Implemented responses, maintaining interface consistency while indicating planned feature status. Tool execution failures result in HTTP 500 Internal Server Error responses with detailed error information and debugging context for troubleshooting.

########## Internal Implementation Details

The global `_current_indexer` variable uses Optional typing to handle uninitialized states and provides thread-safe access patterns for operation coordination. Tool registration uses FastMCP's decorator pattern with nested function definitions, enabling shared access to the global indexer state while maintaining clean encapsulation. Response data structures follow consistent patterns with status fields, operation metadata, statistics dictionaries, and error arrays limited to 10 entries for response size management. Progress reporting integrates FastMCP Context methods throughout tool execution, providing real-time feedback during long-running indexing operations. HTTP response formatting uses the `format_http_response()` helper with consistent status codes, structured payloads, and appropriate content type headers. Error handling includes comprehensive exception logging with stack traces and structured error responses containing error messages, details, and context information for debugging and user guidance.

########### Code Usage Examples

This example demonstrates the tool registration process and integration with a FastMCP server instance. The code shows how to register all knowledge base tools with proper server configuration and logging setup.

```python
from fastmcp.server import FastMCP
from jesse_framework_mcp.knowledge_bases.tools import register_knowledge_bases_tools

# Initialize FastMCP server and register knowledge base tools
server = FastMCP("Jesse Framework MCP")
register_knowledge_bases_tools(server)

# Tools are now available for MCP client invocation
# - knowledge_bases_index_trigger
# - knowledge_bases_status  
# - knowledge_bases_search
```

This example shows how MCP clients would invoke the indexing trigger tool with various configuration options. The code demonstrates the parameter structure and expected response format for successful indexing operations.

```python
# MCP client tool invocation example (conceptual)
response = await mcp_client.call_tool(
    "knowledge_bases_index_trigger",
    {
        "target_path": "./src/",
        "indexing_mode": "incremental", 
        "enable_git_clone_indexing": True,
        "enable_project_base_indexing": False
    }
)

# Expected response structure
{
    "status": "completed",
    "target_path": "/absolute/path/to/src/",
    "indexing_mode": "incremental",
    "statistics": {...},
    "completion_percentage": 100.0,
    "operation_summary": {
        "total_files_discovered": 150,
        "files_completed": 145,
        "files_failed": 5
    }
}
```

---
*Generated: 2025-07-06T23:12:03Z*
*Source Directory: {PROJECT_ROOT}/jesse-framework-mcp/jesse_framework_mcp/knowledge_bases*
*Total Files: 3*
*Total Subdirectories: 3*

# End of knowledge_bases_kb.md